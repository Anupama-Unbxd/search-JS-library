<!DOCTYPE html>
<html lang="en">
   <head>
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
      <meta name="theme-color" content="#000000">
      <title>Unbxd Sdk playground</title>
      <!--required frame works should be loaded here-->
   <link href="/dist/css/unbxdSearch.css" rel="stylesheet">
</head>

   <body>
       


        <h1 class="main-head">SDK will be loaded here</h1>
        <hr/>

        <section class="test-block" >
            <article>
                <h2>Es6</h2>
                <hr/>
                <div id="es6Root">
                    <div id="unbxdTxtWrap">
                    <input id="unbxdInput"/>
                    <button id="searchBtn">search</button>
                    
                </div>
                <div style="display: flex">
                    <div id="paginationContainer"></div>
                    <div id="sortWrapper"></div>
                    <div id="didYouMeanWrapper"></div>
                    <div id="selectedFacetWrapper"></div>
                    <div id="productViewTypeContainer"></div>
                    <div id="changeNoOfProducts"></div>
                </div>
                <div id="breadcrumpContainer"></div>
                <div id="bannerContainer"></div>
                <div style="display:flex">
                    <div>
                        <div id="bucketedFacetWrapper"></div>
                        <div id="facetsWrapper"></div>
                        <div id="rangeFacetWrapper"></div>
                    </div>
                    <div id="searchResultsWrapper"></div>
                    <div id="loaderContainer"></div>
                    <div id="noResultWrapper"></div>
                </div>
                <div id="clickScrollContainer">
                    Load More
                </div>

                </div>

            </article>
        </section>
        <script type = "text/javascript" >  
            /* * * CONFIGURATION * * */
            var UnbxdSiteName = "demo-unbxd700181503576558";
            (function() {
                var ubx = document.createElement ('script');
                ubx.type = 'text/javascript';
                ubx.async = true;
                ubx.src = '//d21gpk1vhmjuf5.cloudfront.net/unbxdAnalytics.js' ;
                (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(ubx);   
            })();
        </script>  
<script type="text/javascript" src="/dist/js/unbxdSearch.js"></script>
<script>

var unbxdCallback = function (instance, type,data){
        console.log(instance, type,data,"unbxdCallbackEcma")
    }
    var es5Unbxd =  new UnbxdSearch({
        searchBoxSelector:document.getElementById("unbxdInput"),
        searchTrigger:"click",
        searchButtonSelector:document.getElementById("searchBtn"),
        searchResultsSelector:document.getElementById("searchResultsWrapper"),
        facetsSelector: document.getElementById("facetsWrapper"),
        selectedFacetSelector: document.getElementById("selectedFacetWrapper"),
        siteKey:"demo-spanish-unbxd809051588861207",
        apiKey:"f19768e22b49909798bc2411fa3dd963",
        sdkHostName:"https://search.unbxd.io/",
        productType:"SEARCH",
        searchQueryParam:"q",
        updateUrls:true,
        productId:"uniqueId",
        searchResultsTemplate : function(product,idx){
            var template = [
                '<div id="'+product.uniqueId+'" data-prank="'+idx+'" data-item="product" class="product-item" style="border:solid 1px red;display:flex">',
                    '<img class="productImgBlock" style="width:100px" src="'+product.imageUrl+'"/>',
                    '<div>',
                        '<h3>'+product.title+'</h3>',
                        '<strong>'+product.sortPrice+'</strong>',
                    '</div>',
                '</div>'
            ].join('');
            return template;
        },
        productItemClass:".product-item",

        mapping: {
            "title": ""
        },
        fields: ['title','uniqueId','sortPrice', 'sku', 'imageUrl'],
        platform: "IO",
        callBackFn:unbxdCallback,
        selectedFacetTemplate : function (selectedFacet,selectedFacetItem){
            return [
                '<div>',
                    '<button class="selected-facet-btn '+this.selectedFacetClass+'"',
                            'data-facet-name="'+selectedFacet.facetName+'"',
                            'data-facet-action ="deleteFacetValue"',
                            'data-id= "'+selectedFacetItem.dataId+'">',
                            ''+selectedFacetItem.name +' '+selectedFacetItem.count+'</button>',
                    '<button class="'+this.selectedFacetClass+'"',
                            'data-id= "'+selectedFacetItem.dataId+'"',
                            'data-facet-action="deleteFacetValue"',
                            'data-facet-name="'+selectedFacet.facetName+'"> x</button>',
                '</div>'
            ].join('')
        },
        facetTemplate: function (facet , value) {
            return [
                '<button data-facet-name="'+facet.facetName+'"',
                    'data-facet-action ="CHANGE_FACET"',
                    'data-id= "'+value.dataId+'">',
                    ''+value.name +' '+value.count+'</button>'
            ].join('');
        },
        facetItemTemplate: function (facet, children) {
            return ['<div id="'+facet.facetName+'">',
                '<h3>'+facet.displayName+'</h3>',
                '<button data-facet-action="deleteFacet" data-facet-name="'+facet.facetName+'" > clear</button>',
                children,
            '</div>'].join('');

        }, 
        facetClass:"select-facets-block",
        facetAction:"click",
        selectedFacetClass:"selected-facet",
        facetMultiSelect: true,
        defaultFilters :null,
        spellCheck: {
            enabled:true,
            el:document.getElementById("didYouMeanWrapper"),
            template:   (suggestion) => {
                return `<p>did you mean <strong>${suggestion}</strong></p>`
            }
        },
        noResultContainer: document.getElementById("noResultWrapper"),
        pageSize: 12,
        //paginationType:'INFINITE_SCROLL',
        inifinteScrollTriggerElement:window,
        //paginationType:'FIXED_PAGINATION',
        //paginationSelector:document.getElementById("paginationContainer"),
        //paginationTemplate:()=>{},
        paginationType:"CLICK_N_SCROLL",
        paginationSelector:document.getElementById("clickScrollContainer"),
        pageSizeContainerSelector:document.getElementById("changeNoOfProducts"),
        pageSizeDisplayType:"Dropdown",
        pageSizeOptions:[6,8,12,16,20],
        heightDiffToTriggerNextPage:100,
        sortContainerSelector:document.getElementById("sortWrapper"),
        sortOptions : [
            {
                value:"sortPrice desc",
                text:"Price High to Low"
            },
            {
                value:"sortPrice asc",
                text:" Price Low to High"
            }/*,
            {
                value:"average_rating asc",
                text:" Rating Low to High"
            },
            {
                value:"average_rating desc",
                text:" Rating High to low"
            }*/
        ],
        sortTemplate:function(selectedSort) {
            var sortBtnsUI = "";
            this.options.sortOptions.forEach((item) => {
                var selectedCss = ""
                if(item.value == selectedSort) {
                    selectedCss = "selcted-sort-btn"
                }
                sortBtnsUI += [
                    '<button class="btn '+selectedCss+'"',
                    'value="'+item.value+'" data-action="changeSort">', 
                        item.text,
                    '</button>'].join('')
            });
            return ['<div>',
                '<h6>sort selections</h6>',
                sortBtnsUI,
                '<button data-action="clearSort">clear sort</button>',
            '</div>'].join('');
        },
        sortAction:"click",
        sortElement:"button",
        loaderTemplate: () =>{
            return '<div>Loading....</div>';
        },
        loaderContainer:document.getElementById('loaderContainer'),
        showVariants:false,
        variantMapping:{
            "image_url":"v_image_url"
        },
        rangeFacetContainer:document.getElementById("rangeFacetWrapper"),
        facetMultilevel: true,
        facetMultilevelName: 'category',
        multiLevelFacetSelector:"bucketFacetElem",
        extraParams :{
            "version":"V2",
            //"facet.multilevel":"categoryPath",
            /*"f.categoryPath.displayName":"category",
            "f.categoryPath.max.depth":"4",
            "f.categoryPath.facet.limit":"100"*/
        },
        multiLevelFacetContainer:document.getElementById("bucketedFacetWrapper"),
        facetDepth:4,
        breadcrumb:true,
        breadcrumbContainer:document.getElementById("breadcrumpContainer"),
        breadcrumbSelectorClass:"bread-crumb",
        showSwatches:true,
        swatchMap:{
            "swatchList":"colours",
            "swatchImgs":"variant_metadata",
            "swatchColors":"unbxd_parentcolours"
        },
        swatchesSelector:"swatchBtn",
        swatchTemplate: function(swatchData) {
            const {
                swatchColors = [],
                swatchImgs = []
            } = swatchData;
            const swatchesSelector = this.swatchesSelector;
            let btnUI = ``;
            swatchColors.forEach((item,id) => {
                const imgId = swatchImgs[id];
                if(imgId){
                    const img = imgId.split("::")[1];
                    btnUI+= `<button 
                            data-swatch-id="${item}"
                            data-swatch-img="${img}" 
                            data-action="changeSwatch"
                            data-swatch-target = ".productImgBlock"
                            class="${swatchesSelector} swatch-btm"
                            style="border:solid 1px ${item}"
                            >${item}</button>`
                }
            });
            return `<div class="swatchContainer">${btnUI}</div>`
        },
        productViewTypes:'GRID',
        gridCount:4,
        productViewTypeSelector: document.getElementById("productViewTypeContainer"),
        productViewTypeAction:"click",
        unbxdAnalytics:true,
        variantConfig: {
            variantsCount: 1,
            variantAttributes: [],
            variantMapping:{
                "image_url":"v_image_url"
            },
            variantsGroupBy: ''
        },
        //bannerSelector:document.getElementById('bannerContainer'),
        applyMultipleFilters:false

    });

    //to make product list it responsive
    window.addEventListener("resize", function() {
        var w = window.innerWidth;
        if(w < 1000) {
            es5Unbxd.options.gridCount = 3;
            es5Unbxd.reRender()
        }
        if(w < 600) {
            es5Unbxd.options.gridCount = 1;
            es5Unbxd.reRender()
        }
        if(w > 1000) {
            es5Unbxd.options.gridCount = 4;
            es5Unbxd.reRender()
        }
    });
</script>
</body>
</html>